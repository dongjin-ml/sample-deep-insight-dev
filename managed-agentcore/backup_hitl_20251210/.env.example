# Production Environment Configuration Template
#
# IMPORTANT:
# 1. This file should be copied to PROJECT ROOT (not production_deployment/)
# 2. Replace all <PLACEHOLDER> values with your actual values
# 3. NEVER commit .env to git (already in .gitignore)
#
# Usage (Automated - Recommended):
#   cd production_deployment/scripts
#   ./setup_env.sh prod
#
# Usage (Manual):
#   cp production_deployment/.env.example .env  # Copy to project root
#   vi .env  # Edit with your values

# ============================================================
# AWS OpenTelemetry Configuration (for per-invocation log streams)
# ============================================================
OTEL_PYTHON_DISTRO=aws_distro
OTEL_PYTHON_CONFIGURATOR=aws_configurator
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
OTEL_EXPORTER_OTLP_LOGS_HEADERS=x-aws-log-group=bedrock-agentcore-observability,x-aws-log-stream=custom-spans,x-aws-metric-namespace=AgentCore
OTEL_RESOURCE_ATTRIBUTES=service.name=deep-insight-runtime # OTEL_RESOURCE_ATTRIBUTES=service.name ==> (cloudwatch) GenAI Observability에서 Agent Name에 적용
AGENT_OBSERVABILITY_ENABLED=true

# ============================================================
# AWS Configuration
# ============================================================
AWS_REGION=us-west-2
AWS_DEFAULT_REGION=us-west-2
AWS_ACCOUNT_ID=<YOUR_AWS_ACCOUNT_ID>

# ============================================================
# Bedrock Model Configuration
# ============================================================
DEFAULT_MODEL_ID=global.anthropic.claude-sonnet-4-20250514-v1:0
COORDINATOR_MODEL_ID=global.anthropic.claude-haiku-4-5-20251001-v1:0
PLANNER_MODEL_ID=global.anthropic.claude-sonnet-4-5-20250929-v1:0
SUPERVISOR_MODEL_ID=global.anthropic.claude-sonnet-4-5-20250929-v1:0
CODER_MODEL_ID=global.anthropic.claude-sonnet-4-20250514-v1:0
VALIDATOR_MODEL_ID=global.anthropic.claude-haiku-4-5-20251001-v1:0
REPORTER_MODEL_ID=global.anthropic.claude-sonnet-4-20250514-v1:0
TRACKER_MODEL_ID=global.anthropic.claude-sonnet-4-5-20250929-v1:0

# ============================================================
# VPC Configuration
# ============================================================
VPC_ID=vpc-<YOUR_VPC_ID>
VPC_CIDR=10.100.0.0/16

# Subnets (Private - use supported AZ only, e.g., use1-az2, use1-az4)
# IMPORTANT: Check supported AZs for Bedrock AgentCore in your region!
PRIVATE_SUBNET_1_ID=subnet-<YOUR_PRIVATE_SUBNET_1_ID>
PRIVATE_SUBNET_2_ID=subnet-<YOUR_PRIVATE_SUBNET_2_ID>
# Example: subnet-0b2fb367d6e823a79, subnet-0ed3a6040386768cf

# ============================================================
# Security Groups
# ============================================================
SG_AGENTCORE_ID=sg-<YOUR_AGENTCORE_SG_ID>
SG_ALB_ID=sg-<YOUR_ALB_SG_ID>
SG_FARGATE_ID=sg-<YOUR_FARGATE_SG_ID>
SG_VPCE_ID=sg-<YOUR_VPCE_SG_ID>

# ============================================================
# ALB Configuration
# ============================================================
ALB_DNS=internal-<YOUR_ALB_NAME>.elb.amazonaws.com
ALB_ARN=arn:aws:elasticloadbalancing:<REGION>:<ACCOUNT>:loadbalancer/app/<NAME>/<ID>
ALB_TARGET_GROUP_ARN=arn:aws:elasticloadbalancing:<REGION>:<ACCOUNT>:targetgroup/<NAME>/<ID>

# ============================================================
# IAM Roles (Phase 1 deployment creates these)
# ============================================================
TASK_EXECUTION_ROLE_ARN=arn:aws:iam::<ACCOUNT>:role/<PROJECT>-task-execution-role-<ENV>
TASK_ROLE_ARN=arn:aws:iam::<ACCOUNT>:role/<PROJECT>-task-role-<ENV>

# ============================================================
# Phase 2: Fargate Runtime (After Phase 2 deployment)
# ============================================================
ECR_REPOSITORY_URI=<ACCOUNT>.dkr.ecr.<REGION>.amazonaws.com/<PROJECT>-fargate-runtime-<ENV>
ECR_REPOSITORY_NAME=<PROJECT>-fargate-runtime-<ENV>
ECS_CLUSTER_ARN=arn:aws:ecs:<REGION>:<ACCOUNT>:cluster/<PROJECT>-cluster-<ENV>
ECS_CLUSTER_NAME=<PROJECT>-cluster-<ENV>
TASK_DEFINITION_ARN=arn:aws:ecs:<REGION>:<ACCOUNT>:task-definition/<PROJECT>-fargate-task-<ENV>
TASK_DEFINITION_FAMILY=<PROJECT>-fargate-task-<ENV>
LOG_GROUP_NAME=/ecs/<PROJECT>-fargate-<ENV>

# Fargate Network Configuration (for Runtime to launch containers)
FARGATE_SUBNET_IDS=<PRIVATE_SUBNET_1_ID>,<PRIVATE_SUBNET_2_ID>
FARGATE_SECURITY_GROUP_IDS=<SG_FARGATE_ID>
FARGATE_ASSIGN_PUBLIC_IP=DISABLED

# Container Configuration
CONTAINER_NAME=fargate-runtime

# ============================================================
# S3 Configuration
# ============================================================
S3_BUCKET_NAME=bedrock-logs-<YOUR_BUCKET_SUFFIX>

# ============================================================
# Human-in-the-Loop (Plan Feedback) Configuration
# ============================================================
# Maximum number of plan revision attempts before auto-approval
MAX_PLAN_REVISIONS=10
# Timeout in seconds to wait for user feedback before auto-approval
PLAN_FEEDBACK_TIMEOUT=300
# Polling interval in seconds to check S3 for feedback file
PLAN_FEEDBACK_POLL_INTERVAL=3

# ============================================================
# Phase 3: AgentCore Runtime (After deployment)
# ============================================================
# These values are populated after running 01_test_launch_with_latest_boto3.py
# Leave empty initially
RUNTIME_NAME=
RUNTIME_ARN=
RUNTIME_ID=

# ============================================================
# Notes
# ============================================================
# 1. Supported AZs for Bedrock AgentCore (us-east-1):
#    - use1-az1, use1-az2, use1-az4, use1-az6 (check current docs)
#
# 2. To find your subnet's AZ ID:
#    aws ec2 describe-subnets --subnet-ids <SUBNET_ID> --query 'Subnets[0].AvailabilityZoneId'
#
# 3. Security Group Requirements:
#    - AgentCore SG: Allow inbound from VPC Endpoint SG, self-referencing
#    - ALB SG: Allow inbound from AgentCore SG
#    - Fargate SG: Allow inbound from ALB SG
#    - VPC Endpoint SG: Allow inbound from AgentCore SG
#
# 4. VPC Endpoints Required:
#    - Bedrock AgentCore Data Plane (Interface)
#    - Bedrock AgentCore Gateway (Interface)
#    - ECR API (Interface)
#    - ECR Docker (Interface)
#    - CloudWatch Logs (Interface)
#    - S3 (Gateway)
